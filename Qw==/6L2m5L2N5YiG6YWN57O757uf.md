#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#define LEN sizeof(struct parking)

struct parking{
	int   	num;		//车位号 
	int  	use;		//是否可用 
	char    name[80];	//车牌号 
	time_t  in;			//入车时间 
}place[100]; 

void ready(FILE *fp);		//初始用户界面 
void getin(FILE *fp);		//存车 
void getout(FILE *fp);		//取车 
void find();				//信息查询 
void change(FILE *fp);		//信息修改 
void ini(FILE *fp);			//信息初始化 
void end();					//结束
 
int main()
{
	int i,a;
	FILE *fp;
	if((fp=fopen("file1.dat","rb+"))==NULL)
	{
		printf("cannot open this file\n");
		exit(0);
	}
	for(i=0;i<100;i++)
	fread(&place[i],LEN,1,fp);
	rewind(fp);
	while(1)
	{
		printf("您是否需要帮助？\n（1）是\n（2）否，关闭程序\n\n\n\n");
		scanf("%d",&a);
		if(a==0)
		{
			printf("输入错误，程序终止\n");break;
		}
		if(a==2) break;
		else if(a==1)
		{
			ready(fp);
		}
		else printf("输入错误，请重新输入\n\n\n\n");
	}
	fclose(fp);
	return 0;
}

void ready (FILE *fp)
{
	int a;
	//printf("\n\n\n\n\n\n");
	printf("请输入您需要的操作：\n");
	printf("(1)存车\n(2)取车\n(3)信息查询\n(4)人工修改\n(5)信息初始化\n(6)退出\n");
	scanf("%d",&a);
L1:	switch (a)
	{
		case (1):getin(fp);break;
		case (2):getout(fp);break;
		case (3):find();break;
		case (4):change(fp);break;
		case (5):ini(fp);break;
		case (6):end();break;
		default:printf("\n\n输入错误，返回主页\n\n\n");break;
	}
}

void end()
{
	printf("\n\n\n已返回主页\n\n");
}

void getin(FILE *fp)
{
	int a,i,j,k=1;
	char s[80]={};
	printf("\n\n\n\n");
	printf("当前车位状况：\n");
	for(i=0;i<100;i++)
	{
		if(place[i].use ==0)
		{
			printf("%-2d号车位可用   ",i);
			if(k%4==0) printf("\n");
			k++;
		}
	}
	if(k==0) printf("\n当前车位已满，无法继续停车\n\n\n");
	else{
		printf("\n您想要手动选取位置还是自动分配位置？\n(1)手动\n(2)自动\n(3)取消\n");
		scanf("%d",&a);
		if(a==1){
			printf("\n请输入您想要的位置\n");
			scanf("%d",&j);
			if(j>=0&&j<100){
			if(place[j].use==1) 
			{
				printf("该车位已有车，请重新操作\n");
				printf("\n\n\n");
			}
			else
			{
				printf("\n请输入您的车牌号\n");
				scanf("%s",s);
				fseek(fp,j*LEN,0);
				place[j].use=1;
				for(i=0;s[i];i++) place[j].name[i]=s[i];
				place[j].name[i]='\0';
				place[j].in=time(NULL);
				fwrite(&place[j],LEN,1,fp);
				rewind(fp);
				printf("\n操作成功\n您当前的车位是：%d\n您当前的车牌号为： %s\n",j,s);
				printf("\n\n");
			}
			}
			else printf("\n\n输入错误，该车位不存在\n\n\n");
		}
		else if(a==2)
		{
			printf("请输入您的车牌号：\n");
			scanf("%s",s);
			for(i=0;i<100;i++)
			{
				if(place[i].use==1) continue;
				if(place[i].use==0)
				{
					for(j=0;s[j];j++) place[i].name[j]=s[j];
					place[i].name[j]='\0';
					place[i].use=1;
					place[i].in=time(NULL);
					fseek(fp,i*LEN,0);
					fwrite(&place[i],LEN,1,fp);
					rewind(fp);
					printf("\n\n\n\n");
					printf("操作成功\n您当前的车位是：%d\n您当前的车牌号为： %s",i,s);
					printf("\n\n\n");
					break;
				}
			}
	 	}
	 	else if(a==3) printf("返回主页\n\n\n");
	 else printf("输入错误,返回主页\n");
}
}

void ini(FILE *fp)
{
	printf("\n\n\n请输入您想要执行的操作：\n");
	printf("(1)信息输入\n(2)信息清零\n(3)取消\n");
	int i,j,a;
	scanf("%d",&a);
	switch(a)
	{
		case(1):{
			time_t m;
			long k;
			m=time(NULL);
			for(i=0;i<100;i++)
		{
			place[i].num=i;
			printf("请输入第%d个车位的信息：是否可用(无车记为0，有车记为1) 车牌号 已停时长\n",i);
			scanf("%d%s%ld",&place[i].use,place[i].name,&k);
			place[i].in=m-k*3600;
			fwrite(&place[i],LEN,1,fp);
			//if(fwrite(&place[i],sizeof(struct parking),1,fp)!=1)
			//printf("file write error\n");
		}
			rewind(fp);
			printf("\n完成输入，返回主页\n\n");
			break;
		}
		case(2):{
			for(i=0;i<100;i++)
			{
				place[i].num=i;
				place[i].use=0;
				place[i].in=0;
				place[i].name[0]=0;
				fwrite(&place[i],LEN,1,fp);
			}
			rewind(fp);
			printf("\n完成清零，返回主页\n\n");
			break;
		}
		case(3):printf("\n\n已取消，返回主页\n\n\n");break;
		default:printf("输入错误\n");
		printf("\n\n\n");break;
	}
	
}

void find()
{
	printf("\n\n\n");
	int i,j,k=1,a,b;
	time_t t;
	char s[80];
	printf("当前车位状况：\n\n");
	for(i=0;i<100;i++)
	{
		if(place[i].use==0)
		{
			printf("%-2d号车位可用  ",i);
			if(k%4==0) printf("\n");
			k++;
		}
	}
	if(k==0) printf("\n当前所有车位已满\n\n");
	printf("\n\n");
	printf("请输入您要查询的类型：\n(1)按车位查询\n(2)按车牌号查询\n(3)取消\n");
	scanf("%d",&a);
	t=time(NULL);
	switch(a)
	{
		case(1):{
			printf("\n\n\n请输入您想要查询的车位：");
			scanf("%d",&b);
			if(b>=0&&b<100&&place[b].use==1){
				printf("该车位号码为：%d\n该处有车\n该车车牌号为%s\n该车已停时长为：%d小时\n",place[b].num,place[b].name,(t-place[b].in)/3600);
			}
			else if(b>=0&&b<100&&place[b].use==0)
			{
				printf("该车位号码为：%d\n该处无车\n",place[b].num);
			}
			else printf("车位不存在\n\n\n");
			printf("\n\n\n\n");
			break;
		}
		case(2):{
			printf("请输入该车的车牌号：\n");
			//gets[s];
			scanf("%s",s);
			for(i=0;i<100;i++)
			{
				if(strcmp(s,place[i].name)==0)
				{
					printf("已查到该车,该车位于%d车位，该车已停时长为%d小时\n\n\n",place[i].num,(t-place[i].in)/3600);
					break;
				}
			}
			if(i==100) printf("\n\n未查到该车，返回主页\n");break;
		}
		case(3):printf("\n\n\n");break;
		default:printf("\n\n输入错误，返回主页\n\n\n\n");break;
	 }
}

void getout(FILE *fp)
{
	printf("请输入您的车牌号：");
	int a,i,z;
	char s[80];
	scanf("%s",s); 
	time_t t;
	t=time(NULL);
	for(i=0;i<100;i++)
	{
		if(strcmp(place[i].name,s)==0){
			printf("您好，您的的车牌号为：%s\n您已经停了%d个小时\n",place[i].name,(t-place[i].in)/3600);
			z=(t-place[i].in)/3600;
			if(z==0)
			{
				printf("请缴费1元"); 
			}
			if(z!=0)
			{
			   printf("请缴费%d 元",z);	
			}
			place[i].use=0;
			place[i].in=0;
			place[i].name[0]=0;
			fseek(fp,i*LEN,0);
			fwrite(&place[a],LEN,1,fp);
			rewind(fp);
			printf("\n已清空该车位信息\n\n\n");
			break;
		}
	}
	if(i==100) printf("该车不存在，取车失败，返回主页\n\n\n");
}

void change(FILE *fp)
{
	printf("请输入您想要改变的车位号：\n");
	int a,b,i;
	long d;
	char s[80];
	time_t t;
	t=time(NULL);
	scanf("%d",&b);
	if(b>=0&&b<100) 
		{
		printf("该车位号码为：%d\n该处是否有车(有车记为1，无车记为0)：%d\n该车车牌号为：%s\n该车已停时长：%d 小时\n",place[b].num,place[b].use,place[b].name,(t-place[b].in)/3600);
		printf("请输入新的的数据:(1)车牌号(2)是否有车(有车记为1，无车记为0)(3)已停时长:\n");
		scanf("%s%d%ld",s,&place[b].use,&d);
		for(i=0;s[i];i++) place[b].name[i]=s[i];
		place[b].name[i]=0;
		t=time(NULL);
		place[b].in=t-d*3600;
		fseek(fp,b*LEN,0);
		fwrite(&place[b],LEN,1,fp);
		rewind(fp);
		printf("完成修改，返回主页\n\n");
		}
		else 	printf("不存在该车位，返回主页\n\n\n");
}